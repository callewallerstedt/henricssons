<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="utf-8"/>
    <title>Bilder & exempel - Henricssons Båtkapell</title>
    <meta name="description" content="Se exempel på våra kapell till olika typer av båtar. Vi har ett brett utbud av kapell för både motorbåtar och segelbåtar."/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="logo.png">
    <script src="script.js"></script>
    <script src="kapellforfragan_full.js"></script>
    <style>
        .bilderex-searchbar { max-width: 400px; margin: 0 auto 2rem auto; display: flex; }
        .bilderex-section { padding: 4rem 1rem; }
        .bilderex-searchbar input { flex: 1; padding: 0.7rem 1rem; border-radius: 4px 0 0 4px; border: 2px solid var(--primary-color); font-size: 1rem; }
        .bilderex-searchbar button { border-radius: 0 4px 4px 0; border: 2px solid var(--primary-color); background: var(--primary-color); color: #0a2342; font-weight: 600; padding: 0 1.3rem; cursor: pointer; }
        .bilderex-searchbar button:hover { background: var(--primary-hover); }
        .bilderex-filters { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; margin-bottom: 2.5rem; }
        .bilderex-filter-btn { background: #fffbe6; border: 1.5px solid var(--primary-color); color: #0a2342; padding: 0.45rem 1.2rem; border-radius: 20px; font-size: 0.95rem; cursor: pointer; transition: background 0.2s, color 0.2s; }
        .bilderex-filter-btn.active, .bilderex-filter-btn:hover { background: var(--primary-color); color: #0a2342; }
        .bilderex-gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 220px)); gap: 1.25rem; justify-content:center; }
        .bilderex-gallery-item { background: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.06); overflow: hidden; display: flex; flex-direction: column; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .bilderex-gallery-item:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.09); }
        .bilderex-gallery-item img { width: 100%; aspect-ratio: 3/2; object-fit: cover; background: #f8f8f8; }
        .bilderex-gallery-caption { padding: 0.9rem 1rem 1rem 1rem; flex: 1; display: flex; flex-direction: column; }
        .bilderex-gallery-caption h3 { margin: 0 0 0.25rem 0; font-size: 1.05rem; font-weight: 600; color: #0a2342; line-height: 1.3; }
        .bilderex-gallery-caption .model { margin: 0 0 0.5rem 0; font-size: 0.9rem; color: #555; }
        .bilderex-gallery-caption .bilderex-cat { font-size: 0.55rem; color: var(--primary-color); font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 0.4rem; }
        .bilderex-gallery-caption .bilderex-link { margin-top: auto; align-self: flex-start; color: #0a2342; background: var(--primary-color); border-radius: 4px; padding: 0.35rem 0.95rem; font-weight: 600; text-decoration: none; transition: background 0.2s; }
        .bilderex-gallery-caption .bilderex-link:hover { background: var(--primary-hover); color: #0a2342; }
        @media (max-width: 600px) { .bilderex-gallery-caption { padding: 0.7rem; } }
        /* Modal styles */
        #bildModal{position:fixed;top:0;left:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;z-index:2000;}
        #bildModal.open{display:flex;}
        #bildModal .modal-backdrop{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.65);}
        #bildModal .modal-content{position:relative;background:#fff;border-radius:8px;max-width:90%;max-height:90%;overflow:auto;padding:1rem;box-shadow:0 8px 25px rgba(0,0,0,0.25);}
        /* Fixed size container for slider to prevent movement - increased by 15% */
        #bildModal .slider{position:relative;width:690px;height:460px;display:flex;align-items:center;justify-content:center;margin:0 auto;}
        #bildModal .slider-main{width:100%;height:100%;object-fit:contain;display:block;cursor:pointer;}
        #bildModal .slide-left,#bildModal .slide-right{background:rgba(255,255,255,0.25);border:none;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;color:#0a2342;cursor:pointer;position:absolute;top:50%;transform:translateY(-50%);z-index:100;font-weight:bold;}
        #bildModal .slide-left{left:10px;}
        #bildModal .slide-right{right:10px;}
        #bildModal .thumb-row{max-width:884px;margin:0.5rem auto 0 auto;flex-wrap:wrap;}
        #bildModal .thumb-row img{width:80px;height:60px;object-fit:cover;border:2px solid transparent;border-radius:4px;cursor:pointer;opacity:0.8;transition:opacity .2s,border-color .2s;}
        #bildModal .thumb-row img.active,#bildModal .thumb-row img:hover{opacity:1;border-color:var(--primary-color);}
        #bildModal .modal-close{position:absolute;top:6px;right:10px;font-size:28px;font-weight:700;cursor:pointer;color:#0a2342;z-index:120;}
        #bildModal .modal-text{max-width:884px;margin:0 auto;}
        #bildModal .modal-text p{margin:0.3rem 0;font-size:0.95rem;color:#0a2342;}
        #bildModal .modal-text h4{margin:0.7rem 0 0.3rem 0;font-size:1.05rem;color:#0a2342;font-weight:700;}
        #bildModal .modal-heading{margin:0 0 0.4rem 0;color:#0a2342;font-size:1.35rem;font-weight:700;text-align:center;}
        #bildModal .modal-model{margin:0 0 0.8rem 0;color:#555;font-size:1.05rem;font-weight:600;text-align:center;}
        #bildModal .modal-btn{display:inline-block;background:var(--primary-color);color:#0a2342;font-weight:600;padding:0.55rem 1.4rem;border-radius:6px;text-decoration:none;margin-top:1rem;}
        #bildModal .modal-btn:hover{background:var(--primary-hover);}
        /* Fullscreen modal */
        #fullscreenModal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.95);display:none;align-items:center;justify-content:center;z-index:3000;cursor:pointer;}
        #fullscreenModal.open{display:flex;}
        #fullscreenModal img{max-width:95%;max-height:95%;object-fit:contain;}
        #fullscreenModal .fullscreen-close{position:absolute;top:20px;right:30px;font-size:40px;font-weight:700;cursor:pointer;color:#ffffff;z-index:3001;background:rgba(0,0,0,0.5);width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:none;}
        #fullscreenModal .fullscreen-close:hover{background:rgba(0,0,0,0.7);}
        @media (max-width: 768px) {
            #bildModal .slider{width:460px;height:345px;}
        }
        @media (max-width: 480px) {
            .bilderex-searchbar input { font-size: 0.8rem; padding: 0.55rem 0.8rem; }
            .bilderex-searchbar button { font-size: 0.8rem; padding: 0 1rem; }
            .bilderex-filter-btn { padding: 0.35rem 0.9rem; font-size: 0.8rem; }
            .bilderex-gallery-grid { grid-template-columns: repeat(2, 1fr); gap: 0.8rem; padding: 0 0.4rem; }
            .bilderex-gallery-caption h3 { font-size: 0.9rem; }
            .bilderex-gallery-caption .model { font-size: 0.8rem; }
            .bilderex-gallery-caption .bilderex-cat { font-size: 0.45rem; margin-bottom: 0.3rem; }
            .bilderex-gallery-caption .bilderex-link { font-size: 0.8rem; padding: 0.25rem 0.8rem; }
            #bildModal .slider { width: 300px; height: 214px; }
            #bildModal .thumb-row img { width: 60px; height: 45px; }
            #bildModal .modal-heading { font-size: 1.1rem; }
            #bildModal .modal-model { font-size: 0.9rem; }
            #bildModal .modal-text h4 { font-size: 0.9rem; margin: 0.6rem 0 0.25rem 0; }
            #bildModal .modal-text p { font-size: 0.85rem; }
            #bildModal .modal-btn { font-size: 0.85rem; padding: 0.45rem 1rem; }
            .container { padding: 0 0.4rem; }
        }
        /* removed: global narrow container padding; keep mobile override only */
    </style>
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <a href="index.html" class="nav-logo">
                <img src="logo.png" alt="Henricssons Båtkapell Logo"/>
            </a>
            <button class="menu-btn" aria-label="Toggle menu">
                <span class="menu-line"></span>
                <span class="menu-line"></span>
                <span class="menu-line"></span>
            </button>
            <div class="nav-menu">
                <a href="om-oss.html" class="nav-link">Om oss</a>
                <a href="kapellforfragan.html" class="nav-link">Kapellförfrågan</a>
                <a href="bilder-och-exempel.html" class="nav-link active">Bilder & exempel</a>
                <a href="tillbehor.html" class="nav-link">Fenderstrumpor</a>
                <a href="kontakt.html" class="nav-link">Kontakt</a>
            </div>
        </nav>
    </header>
    <div class="cta-line--nav"></div>
    <div class="nav-rugged-border"></div>
    <main>
        <section class="hero hero--bilder">
            <div class="hero-content hero-content--centered">
                <h1 class="hero-title">Bilder & exempel</h1>
                <div class="divider"></div>
                <p class="hero-text">Se exempel på våra kapell till olika typer av båtar. Vi har ett brett utbud av kapell för både motorbåtar och segelbåtar.</p>
                <div class="hero-down-arrow" aria-hidden="true">&#8595;</div>
            </div>
        </section>
        <div class="cta-line"></div>
        <section class="bilderex-section">
            <div class="container">
                <form class="bilderex-searchbar" onsubmit="event.preventDefault(); bilderexApplyFilter();">
                    <input type="text" id="bilderex-search" placeholder="Sök båt, modell eller kategori..." autocomplete="off"/>
                    <button type="button" onclick="bilderexClearSearch()">Rensa</button>
                </form>
                <div class="bilderex-filters" id="bilderex-filters"></div>
                <div class="bilderex-gallery-grid" id="bilderex-gallery"></div>
            </div>
        </section>
        <section class="cta">
            <div class="cta-inner">
                <h2>Behöver du ett nytt kapell?</h2>
                <p>Kontakta oss för en kostnadsfri offert eller besök vår verkstad i Kungsbacka.</p>
                <a href="kapellforfragan.html" class="btn btn-primary btn-large">Gör en kapellförfrågan</a>
            </div>
        </section>
        <div class="cta-line"></div>
    </main>
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <img src="logo.png" alt="Henricssons Båtkapell Logo" class="footer-logo"/>
                <div class="divider" style="margin-left:0; margin-right:auto;"></div>
                <p>Vi gör kapell till många olika typer av båtar. Med vårat mallregister med egen tillverkning och tillsammans med vår import av originalkapell från Norge Finland och Danmark så täcker vi ett brett register av modeller</p>
            </div>
            <div class="footer-section">
                <h2 style="text-align:left;">Partners</h2>
                <div class="divider" style="margin-left:0; margin-right:auto;"></div>
                <div class="partners-grid">
                    <img src="assets/jens sagen.png" alt="Jens Sagen" class="partner-logo"/>
                    <img src="assets/5e79d73a63cc8b5939552a05_helly-hansen.svg" alt="Helly Hansen" class="partner-logo"/>
                    <img src="assets/Varuste.png" alt="VA Varuste" class="partner-logo"/>
                    <img src="assets/schultz.png" alt="Schultz Kalecher" class="partner-logo"/>
                    <img src="assets/mpvenekuomo.png" alt="MP Venekuomu" class="partner-logo" style="grid-column: span 2;"/>
                </div>
            </div>
            <div class="footer-section">
                <h2 style="text-align:left;">Kontakt</h2>
                <div class="divider" style="margin-left:0; margin-right:auto;"></div>
                <p>
                    +46 (0)31 471820<br/>
                    Energigatan 17E<br/>
                    434 37 Kungsbacka<br/>
                    <a href="mailto:info@henricssonsbatkapell.se">info@henricssonsbatkapell.se</a>
                </p>
            </div>
        </div>
    </footer>
    <script>
var bilderexData = [];
var extrasData = {};

function buildData() {
    bilderexData = [];
    if (extrasData && typeof extrasData === 'object') {
        // Anpassa för models_meta.json-formatet
        Object.entries(extrasData).forEach(([slug, item]) => {
            // Kategori-mappning
            let catMap = {
                'Motorbåtar': {label:'Motorbåtar', key:'motorbåtar'},
                'Segelbåtar': {label:'Segelbåtar', key:'segelbåtar'},
                'Båtstolar & Dynor': {label:'Båtstolar & Dynor', key:'båtstol'},
                'Vävprover övriga': {label:'Vävprover övriga', key:'färgprover'},
                'Specialsömnad & Skräddarsytt': {label:'Specialsömnad & Skräddarsytt', key:'specialsömnadskräddarsytt'},
                'Sunbrella Plus Kollektion vävprover': {label:'Sunbrella Plus Kollektion vävprover', key:'sunbrella'}
            };
            const map = catMap[item.category] || {label:'Övrigt', key:'other'};
            // Gör om bildsökvägar till web-vänliga paths
            const imgs = (item.images && item.images.length ? item.images : []).map(img =>
                img.startsWith('data:') ? img : 'henricssons_bilder/' + img.replace(/\\/g, '/'));
            const finalImgs = imgs.length ? imgs : ['logo.png'];
            bilderexData.push({
                namn: item.model,
                tillverkare: item.manufacturer || '',
                kategori: map.label,
                kategoriKey: map.key,
                images: finalImgs,
                variant: item.variant || '',
                leverans: item.delivery || '',
                beskrivning: item.description || ''
            });
        });
    }
    bilderexData.forEach((obj, i) => { obj._idx = i; });
}

const bilderexKategorier = [
    { key: "all", label: "Visa alla" },
    { key: "motorbåtar", label: "Motorbåtar" },
    { key: "segelbåtar", label: "Segelbåtar" },
    { key: "båtstol", label: "Båtstolar & Dynor" },
    { key: "färgprover", label: "Vävprover övriga" },
    { key: "specialsömnadskräddarsytt", label: "Specialsömnad & Skräddarsytt" },
    { key: "sunbrella", label: "Sunbrella Plus Kollektion vävprover" }
];
// --- FILTER OCH SÖK ---
let bilderexCurrentFilter = "all";
function bilderexRenderFilters() {
    const filters = document.getElementById('bilderex-filters');
    filters.innerHTML = '';
    bilderexKategorier.forEach(cat => {
        const btn = document.createElement('button');
        btn.className = 'bilderex-filter-btn' + (bilderexCurrentFilter === cat.key ? ' active' : '');
        btn.textContent = cat.label;
        btn.onclick = () => { bilderexCurrentFilter = cat.key; bilderexApplyFilter(); };
        filters.appendChild(btn);
    });
}
function bilderexClearSearch() {
    document.getElementById('bilderex-search').value = '';
    bilderexApplyFilter();
}
function bilderexApplyFilter() {
    const search = document.getElementById('bilderex-search').value.trim().toLowerCase();
    let items = bilderexData;
    if (bilderexCurrentFilter !== 'all') {
        items = items.filter(item => (item.kategoriKey || '').toLowerCase() === bilderexCurrentFilter);
    }
    if (search) {
        items = items.filter(item =>
            (item.namn && item.namn.toLowerCase().includes(search)) ||
            (item.tillverkare && item.tillverkare.toLowerCase().includes(search)) ||
            (item.kategori && item.kategori.toLowerCase().includes(search))
        );
    }
    bilderexRenderGallery(items);
    bilderexRenderFilters();
}
function bilderexRenderGallery(items) {
    const grid = document.getElementById('bilderex-gallery');
    grid.innerHTML = '';
    if (!items.length) {
        grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:#bfa100;font-weight:600;padding:2rem 0;">Inga träffar</div>';
        return;
    }
    items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'bilderex-gallery-item';
        const thumb = (item.images&&item.images.length)? item.images[0] : 'logo.png';
        div.innerHTML = `
            <a href="#" class="bilderex-thumb" data-idx="${item._idx}" tabindex="0">
                <img src="${thumb}" alt="${item.namn}" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"/>
                <div class="bilderex-no-image" style="display:none; width:100%; aspect-ratio:3/2; background:#f8f8f8; align-items:center; justify-content:center; color:#999; font-size:0.9rem; font-weight:500;">Bild saknas</div>
            </a>
            <div class="bilderex-gallery-caption">
                <div class="bilderex-cat">${item.kategori || ''}</div>
                <h3>${item.tillverkare}</h3>
                <p class="model">${item.namn}</p>
                <a href="#" class="bilderex-link bilderex-thumb" data-idx="${item._idx}">Visa</a>
            </div>
        `;
        grid.appendChild(div);
    });
    bindThumbClicks();
}
// Modal viewer
function bindThumbClicks(){
    document.querySelectorAll('.bilderex-thumb').forEach(el=>{
        el.addEventListener('click',function(e){
            e.preventDefault();
            const idx=parseInt(this.dataset.idx,10);
            openModal(idx);
        });
    });
}
let currentModalIdx=0;
let currentImages=[];
function openModal(dataIndex){
    const item=bilderexData[dataIndex];
    currentImages=item.images && item.images.length? item.images : ['logo.png'];
    currentModalIdx=0;
    let modal=document.getElementById('bildModal');
    if(!modal){
        modal=document.createElement('div');
        modal.id='bildModal';
        modal.innerHTML=`<div class="modal-backdrop"></div><div class="modal-content"><span class="modal-close">&times;</span><div class="slider"><button class="slide-left">‹</button><img class="slider-main" src="" alt=""/><button class="slide-right">›</button></div><div class="thumb-row"></div><h2 class="modal-heading"></h2><h3 class="modal-model"></h3><div class="modal-text"></div><a href="#" class="modal-btn" id="modal-request-btn">Skicka förfrågan</a></div>`;
        document.body.appendChild(modal);
        modal.querySelector('.modal-close').onclick=function(e){
            e.stopPropagation();
            closeModal();
        };
        modal.querySelector('.modal-backdrop').onclick=closeModal;
    }
    // Create fullscreen modal if it doesn't exist
    let fullscreenModal=document.getElementById('fullscreenModal');
    if(!fullscreenModal){
        fullscreenModal=document.createElement('div');
        fullscreenModal.id='fullscreenModal';
        fullscreenModal.innerHTML=`<button class="fullscreen-close">&times;</button><img src="" alt=""/>`;
        document.body.appendChild(fullscreenModal);
        // Only close on backdrop click, not on image click
        fullscreenModal.onclick = function(e) {
            if (e.target === fullscreenModal) {
                closeFullscreen();
            }
        };
        fullscreenModal.querySelector('.fullscreen-close').onclick = function(e){
            e.stopPropagation();
            closeFullscreen();
        };
    }
    function renderSlide(){
        const mainImg = modal.querySelector('.slider-main');
        mainImg.src = currentImages[currentModalIdx];
        // Add error handling for main image
        mainImg.onerror = function() {
            this.style.display = 'none';
            if (!this.nextElementSibling || !this.nextElementSibling.classList.contains('modal-no-image')) {
                const noImageDiv = document.createElement('div');
                noImageDiv.className = 'modal-no-image';
                noImageDiv.style.cssText = 'width:100%; height:100%; background:#f8f8f8; display:flex; align-items:center; justify-content:center; color:#999; font-size:1.1rem; font-weight:500;';
                noImageDiv.textContent = 'Bild saknas';
                this.parentNode.insertBefore(noImageDiv, this.nextSibling);
            }
        };
        mainImg.onload = function() {
            this.style.display = 'block';
            const noImageDiv = this.nextElementSibling;
            if (noImageDiv && noImageDiv.classList.contains('modal-no-image')) {
                noImageDiv.style.display = 'none';
            }
        };
        // Add click event for fullscreen
        mainImg.onclick = () => openFullscreen(currentImages[currentModalIdx]);
        modal.querySelectorAll('.thumb-row img').forEach((t,i)=>{ t.classList.toggle('active', i===currentModalIdx);});
    }
    const thumbRow=modal.querySelector('.thumb-row');
    thumbRow.innerHTML='';
    currentImages.forEach((src,i)=>{
        const ti=document.createElement('img'); 
        ti.src=src; 
        ti.className=i===0?'active':''; 
        ti.onerror = function() {
            this.style.display = 'none';
            if (!this.nextElementSibling || !this.nextElementSibling.classList.contains('thumb-no-image')) {
                const noImageDiv = document.createElement('div');
                noImageDiv.className = 'thumb-no-image';
                noImageDiv.style.cssText = 'width:80px; height:60px; background:#f8f8f8; display:flex; align-items:center; justify-content:center; color:#999; font-size:0.7rem; font-weight:500; border:2px solid transparent; border-radius:4px;';
                noImageDiv.textContent = 'Bild saknas';
                this.parentNode.insertBefore(noImageDiv, this.nextSibling);
            }
        };
        ti.onload = function() {
            this.style.display = 'block';
            const noImageDiv = this.nextElementSibling;
            if (noImageDiv && noImageDiv.classList.contains('thumb-no-image')) {
                noImageDiv.style.display = 'none';
            }
        };
        ti.onclick=()=>{currentModalIdx=i; renderSlide();}; 
        thumbRow.appendChild(ti);
    });
    modal.querySelector('.slide-left').onclick=()=>{ 
        currentModalIdx=(currentModalIdx-1+currentImages.length)%currentImages.length; 
        renderSlide(); 
    };
    modal.querySelector('.slide-right').onclick=()=>{ 
        currentModalIdx=(currentModalIdx+1)%currentImages.length; 
        renderSlide(); 
    };
    renderSlide();
    modal.querySelector('.modal-heading').textContent=item.tillverkare;
    modal.querySelector('.modal-model').textContent=item.namn;
    modal.querySelector('.modal-text').innerHTML = `
        <h4>Beskrivning</h4>
        <p>${item.beskrivning || '-'}</p>
        <h4>Variant</h4>
        <p>${item.variant || '-'}</p>
        <h4>Leveransinfo</h4>
        <p>${item.leverans || '-'}</p>
    `;
    const reqBtn=modal.querySelector('#modal-request-btn');
    reqBtn.onclick=function(e){
        e.preventDefault();
        localStorage.setItem('preselectManufacturer',item.tillverkare);
        localStorage.setItem('preselectModel',item.namn);
        window.location.href='kontakt.html';
    };
    modal.classList.add('open');
}
function openFullscreen(imageSrc){
    const fullscreenModal=document.getElementById('fullscreenModal');
    fullscreenModal.querySelector('img').src=imageSrc;
    fullscreenModal.classList.add('open');
}
function closeFullscreen(){
    document.getElementById('fullscreenModal').classList.remove('open');
}
function closeModal(){document.getElementById('bildModal').classList.remove('open');}
// --- INIT ---
document.addEventListener('DOMContentLoaded', function() {
    const extrasDataPath='henricssons_bilder/models_meta.json?v=' + Date.now();
    fetch(extrasDataPath).then(r=>r.json()).then(json=>{ extrasData=json||{}; }).catch(()=>{ extrasData={}; }).finally(()=>{
        buildData();
        bilderexRenderFilters();
        bilderexApplyFilter();
        document.getElementById('bilderex-search').addEventListener('input', bilderexApplyFilter);
    });
});
    </script>
</body>
</html> 